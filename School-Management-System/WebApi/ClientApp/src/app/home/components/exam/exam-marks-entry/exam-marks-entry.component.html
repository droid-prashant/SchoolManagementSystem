<!-- src/app/components/student-form/student-form.component.html -->

<h2 class="mb-4">Exam Marks Entry</h2>

<form [formGroup]="studentCategory" class="p-fluid">
    <div class="formgrid grid">

        <div class="field col-3">
            <label>Class</label>
            <p-dropdown [options]="classRooms" optionLabel="name" optionValue="id" formControlName="classRoomId"
                (onChange)="onClassRoomChange()" placeholder="Select Class"></p-dropdown>
        </div>

        <div class="field col-3">
            <label>Section</label>
            <p-dropdown [options]="sections" optionLabel="name" optionValue="id" formControlName="sectionId"
                [disabled]="!isClassSelected" placeholder="Select Section"></p-dropdown>
        </div>

        <div class="col-12 text-right mt-2">
            <button type="submit" pButton label="Register" class="p-button-success"></button>
        </div>
    </div>

    <!-- Subject Marks Entry Modal -->
    <!-- Start -->
    <div class="card flex justify-content-center subject-marks-form">
        <p-dialog header="Subject Marks Entry" [modal]="true" [(visible)]="isMarksEntryVisible">
            <!-- table -->
            <div formArrayName="marks" class="card">
                <p-table [value]="courses">
                    <ng-template pTemplate="header">
                        <tr>
                            <th style="width:25%">Id</th>
                            <th style="width:25%">Subject Name</th>
                            <th style="width:25%">Marks</th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-course let-rowIndex="rowIndex">
                        <tr [formGroup]="getFormGroup(rowIndex)">
                            <td>{{ rowIndex + 1 }}</td>
                            <td>{{course.name}} {{course.courseType}}</td>
                            <td>
                                <input pInputText type="number" formControlName="obtainedMarks"
                                    class="p-inputtext p-component input-number" placeholder="Enter marks" [min]="0"
                                    [max]="100" />
                                <!-- <input type="number" formControlName="mark" class="p-inputtext p-component input-number"
                                    [maxlength]="3" placeholder="Enter marks"> -->
                            </td>
                        </tr>
                    </ng-template>
                </p-table>
            </div>
            <!---->
            <button pButton pRipple label="Submit" class="p-button-success" (click)="saveStudentMarks()">
            </button>
        </p-dialog>
    </div>
    <!-- End -->
</form>
<p-toast></p-toast>
<div class="card">
    <p-table [value]="students" [paginator]="true" [rows]="5" [tableStyle]="{ 'min-width': '50rem' }"
        [rowsPerPageOptions]="[5, 10, 20]">
        <ng-template pTemplate="header">
            <tr>
                <th style="width:25%">Id</th>
                <th style="width:25%">Name</th>
                <th style="width:25%">Class</th>
                <th style="width:25%">Section</th>
                <th style="width:25%">Gender</th>
                <th style="width:25%">Address</th>
                <th style="width:25%">Action</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-student let-rowIndex="rowIndex">
            <tr>
                <td>{{ rowIndex + 1 }}</td>
                <td>{{ student.name }}</td>
                <td>{{ student.classRoom }}</td>
                <td>{{ student.section }}</td>
                <td>{{ student.gender }}</td>
                <td>{{ student.address }}</td>
                <td>
                    <i class="pi pi-pencil pointer-icon" (click)="showDialog()"></i>
                </td>
            </tr>
        </ng-template>
    </p-table>
</div>